<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Schedule Meeting</title>

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">

  <style>
    body {
      background: #f5f7fb;
      font-family: Inter, sans-serif;
    }

    .schedule-wrapper {
      max-width: 1000px;
      margin: 30px auto;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.12);
      border-radius: 20px;
      overflow: hidden;
      background: #f9fafb;
    }

    .schedule-left {
      background: linear-gradient(150deg,#0f172a 0%,#111827 50%,#1d4ed8 100%);
      color:#e5e7eb;
      padding:40px;
    }
    .logo-circle{
      width:60px;height:60px;border-radius:50%;
      background:rgba(255,255,255,0.1);
      display:flex;align-items:center;justify-content:center;
      font-size:28px;font-weight:700;
    }

    .schedule-right { padding:28px; }

    /* Calendar UI */
    .calendar-table{width:100%;text-align:center;}
    .calendar-day{
      width:36px;height:36px;line-height:36px;border-radius:50%;
      cursor:pointer;margin:auto;font-size:.82rem;border:1px solid transparent;
    }
    .calendar-day.disabled{color:#c0c0c0;cursor:not-allowed;}
    .calendar-day.past{color:#9e9e9e;cursor:not-allowed;}
    .calendar-day:hover:not(.disabled):not(.past){
      background:#eff6ff;border-color:#bfdbfe;
    }
    .calendar-day.selected{background:#2563eb;color:#fff;}

    /* Duration cards */
    .slot-length-card{
      padding:10px;border:1px solid #e5e7eb;border-radius:12px;
      margin-bottom:10px;cursor:pointer;background:#fff;display:flex;gap:10px;
    }
    .slot-length-card.active{
      border-color:#2563eb;background:rgba(37,99,235,0.08);
    }
    .dot{width:10px;height:10px;border-radius:50%;}
    .dot-red{background:#ef4444;}
    .dot-blue{background:#3b82f6;}
    .dot-yellow{background:#facc15;}

    .time-slot-grid{
      display:grid;grid-template-columns:repeat(2,1fr);
      gap:10px;
    }
    .time-slot-btn{
      padding:8px;border-radius:10px;border:1px solid #e5e7eb;
      background:#fff;cursor:pointer;font-size:.85rem;
    }
    .time-slot-btn.selected{
      background:#2563eb;color:#fff;border-color:#2563eb;
    }

    @media(max-width:767px){
      .schedule-wrapper{margin:10px;}
      .time-slot-grid{grid-template-columns:1fr;}
    }

    #scheduleAlert{border-radius:8px;font-size:.85rem;padding:6px 10px;}
  </style>
</head>
<body>

<div  class="schedule-wrapper">
  <div class="row g-0">

    <!-- LEFT PANEL -->
    <div class="col-md-4 d-none d-md-flex">
      <div class="schedule-left w-100">
        <div class="logo-circle mb-4">S</div>
        <h5 class="mb-3">Welcome to my calendar!</h5>
        <p>Choose a convenient date and slot so that I can reach you on time.</p>
      </div>
    </div>

    <!-- RIGHT PANEL -->
    <div class="col-md-8">
      <div class="schedule-right">

        <h5 class="fw-bold mb-1">Schedule a Meeting</h5>
        <small id="stepLabel" class="text-muted">Step 1 of 2 â€“ Select Date & Slot</small>
        <div id="scheduleAlert" class="alert alert-danger d-none mt-2"></div>

        <!-- STEP 1 -->
        <div id="step1" class="mt-3">
          <div class="row">
            <div class="col-lg-7">
              <small class="text-muted">Date Selection</small>
              <div class="d-flex justify-content-between align-items-center mt-1">
                <div id="calendarMonthLabel" class="fw-semibold"></div>
                <div>
                  <button id="prevMonthBtn" class="btn btn-sm btn-light border">&lt;</button>
                  <button id="nextMonthBtn" class="btn btn-sm btn-light border ms-1">&gt;</button>
                </div>
              </div>
              <table class="calendar-table mt-2">
                <thead><tr><th>Sun</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th></tr></thead>
                <tbody id="calendarBody"></tbody>
              </table>
            </div>

            <div class="col-lg-5">
              <small class="text-muted">Choose Duration</small>

              <div class="slot-length-card" data-duration="45">
                <div class="dot dot-red"></div> 45 Mins
              </div>
              <div class="slot-length-card" data-duration="30">
                <div class="dot dot-blue"></div> 30 Mins
              </div>
              <div class="slot-length-card" data-duration="15">
                <div class="dot dot-yellow"></div> 15 Mins
              </div>

              <div class="text-end mt-3">
                <button id="goToStep2Btn" class="btn btn-primary btn-sm">Next</button>
              </div>
            </div>
          </div>
        </div>

        <!-- STEP 2 -->
        <div id="step2" class="d-none mt-4">
          <div class="row">
            <div class="col-lg-5 mb-3">
              <small class="text-muted">Selected Date</small>
              <div id="confirmDateLabel" class="fw-bold mb-3"></div>
              <div id="timeSlotsContainer" class="time-slot-grid"></div>
            </div>

            <div class="col-lg-7">
              <small class="text-muted">Enter Details</small>
              <form id="meetingDetailsForm" class="mt-2">
                <input id="fullNameInput" class="form-control form-control-sm mb-2" placeholder="Full Name*" required>
                <input id="emailInput" class="form-control form-control-sm mb-2" type="email" placeholder="Email*" required>
                <input id="subjectInput" class="form-control form-control-sm mb-2" placeholder="Subject*" required>
                <input id="websiteInput" class="form-control form-control-sm mb-2" placeholder="Website (optional)">
                <input id="phoneInput" class="form-control form-control-sm mb-3" placeholder="Phone*" required>

                <div class="d-flex justify-content-between">
                  <button type="button" id="backToStep1Btn" class="btn btn-outline-secondary btn-sm">Back</button>
                  <button class="btn btn-primary btn-sm">Confirm & Open Calendar</button>
                </div>
              </form>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
(function(){
  const timeSlots = {
    "45": ["07:30 pm","08:15 pm","09:00 pm","09:45 pm","10:30 pm","11:15 pm"],
    "30": ["07:30 pm","08:00 pm","08:30 pm","09:00 pm","09:30 pm"],
    "15": ["07:30 pm","07:45 pm","08:00 pm","08:15 pm","08:30 pm"]
  };

  // Month and weekday names used by the calendar renderer
  const months = [
    "January","February","March","April","May","June",
    "July","August","September","October","November","December"
  ];
  const days = [
    "Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"
  ];

  let currentMonth = new Date(); currentMonth.setDate(1);
  let selectedDate=null, selectedDuration=null, selectedTime=null;

  const calendarBody=document.getElementById("calendarBody");
  const calendarMonthLabel=document.getElementById("calendarMonthLabel");
  const prevMonthBtn=document.getElementById("prevMonthBtn");
  const nextMonthBtn=document.getElementById("nextMonthBtn");
  const durationCards=document.querySelectorAll(".slot-length-card");
  const timeSlotsContainer=document.getElementById("timeSlotsContainer");
  const goToStep2Btn=document.getElementById("goToStep2Btn");
  const backToStep1Btn=document.getElementById("backToStep1Btn");
  const confirmDateLabel=document.getElementById("confirmDateLabel");
  const step1=document.getElementById("step1");
  const step2=document.getElementById("step2");
  const stepLabel=document.getElementById("stepLabel");
  const alertBox=document.getElementById("scheduleAlert");
  const form=document.getElementById("meetingDetailsForm");

  function showError(t){alertBox.textContent=t;alertBox.classList.remove("d-none")}
  function clearError(){alertBox.classList.add("d-none")}

  function renderCalendar(){
    const y=currentMonth.getFullYear();
    const m=currentMonth.getMonth();
    calendarMonthLabel.textContent=months[m]+" "+y;
    calendarBody.innerHTML="";
    const first=new Date(y,m,1).getDay();
    const total=new Date(y,m+1,0).getDate();
    let row=document.createElement("tr");
    const now=new Date();now.setHours(0,0,0,0);

    for(let i=0;i<first;i++) row.appendChild(document.createElement("td"));

    for(let d=1;d<=total;d++){
      let date=new Date(y,m,d);
      let td=document.createElement("td");
      let btn=document.createElement("div");
      btn.textContent=d;
      btn.className="calendar-day";

      if(date<now) btn.classList.add("past");
      if(date.getDay()==0) btn.classList.add("disabled");

      btn.onclick=function(){
        if(btn.classList.contains("past")||btn.classList.contains("disabled")) return;
        selectedDate=date;
        document.querySelectorAll(".calendar-day").forEach(e=>e.classList.remove("selected"));
        btn.classList.add("selected");
      };

      td.appendChild(btn);
      row.appendChild(td);
      if(date.getDay()==6){calendarBody.appendChild(row);row=document.createElement("tr")}
    }
    if(row.children.length) calendarBody.appendChild(row);
  }

  document.addEventListener("DOMContentLoaded", renderCalendar);

  prevMonthBtn.onclick=()=>{currentMonth.setMonth(currentMonth.getMonth()-1);renderCalendar();}
  nextMonthBtn.onclick=()=>{currentMonth.setMonth(currentMonth.getMonth()+1);renderCalendar();}

  durationCards.forEach(c=>{
    c.onclick=()=>{
      durationCards.forEach(x=>x.classList.remove("active"));
      c.classList.add("active");
      selectedDuration=c.dataset.duration;
    }
  });

  goToStep2Btn.onclick=()=>{
    if(!selectedDate) return showError("Select a date");
    if(!selectedDuration) return showError("Select duration");
    clearError();

    confirmDateLabel.textContent =
      days[selectedDate.getDay()] + ", " +
      selectedDate.getDate() + " " +
      months[selectedDate.getMonth()] + " " +
      selectedDate.getFullYear();

    timeSlotsContainer.innerHTML="";
    timeSlots[selectedDuration].forEach(t=>{
      const b=document.createElement("button");
      b.type="button";
      b.className="time-slot-btn";
      b.textContent=t;
      b.onclick=function(){
        document.querySelectorAll(".time-slot-btn").forEach(e=>e.classList.remove("selected"));
        b.classList.add("selected");
        selectedTime=t;
      };
      timeSlotsContainer.appendChild(b);
    });

    step1.classList.add("d-none");
    step2.classList.remove("d-none");
    stepLabel.textContent="Step 2 of 2 â€“ Confirm & Details";
  };

  backToStep1Btn.onclick=()=>{
    step2.classList.add("d-none");
    step1.classList.remove("d-none");
    stepLabel.textContent="Step 1 of 2 â€“ Select Date & Slot";
  };

  /* ðŸ”¥ SUBMIT HANDLER (Saves + Opens Calendar) */
  form.onsubmit=e=>{
    e.preventDefault();
    if(!selectedTime) return showError("Select time");

    const name=document.getElementById("fullNameInput").value.trim();
    const email=document.getElementById("emailInput").value.trim();
    const subject=document.getElementById("subjectInput").value.trim();
    const website=document.getElementById("websiteInput").value.trim();
    const phone=document.getElementById("phoneInput").value.trim();
    if(!name||!email||!subject||!phone) return showError("All required fields must be filled");

    /* ðŸ“Œ SAVE USER DATA IN BROWSER for future EmailJS */
    const meetingData = {
      name,
      email,
      subject,
      website,
      phone,
      date: confirmDateLabel.textContent,
      time: selectedTime,
      duration: selectedDuration,
      createdAt: new Date().toISOString()
    };
    localStorage.setItem("scheduledMeeting", JSON.stringify(meetingData));
    console.log("Collected Data Saved â†’", meetingData);

    /* ðŸ“Œ GOOGLE CALENDAR */
    const [hm, ap] = selectedTime.split(" ");
    let [h, m] = hm.split(":");
    h=parseInt(h); m=parseInt(m);
    if(ap==="pm" && h!=12) h+=12;

    const start=new Date(selectedDate);
    start.setHours(h,m,0,0);
    const end=new Date(start.getTime() + parseInt(selectedDuration)*60000);
    function fmt(d){return d.toISOString().replace(/[-:]/g,"").split(".")[0]+"Z"}

    const url =
      "https://calendar.google.com/calendar/r/eventedit?" +
      "text=" + encodeURIComponent("Meeting - " + subject) +
      "&details=" + encodeURIComponent(
        "Name: " + name +
        "\nEmail: " + email +
        "\nPhone: " + phone +
        (website ? "\nWebsite: " + website : "")
      ) +
      "&dates=" + fmt(start) + "/" + fmt(end);

    window.open(url, "_blank");
  };

})();
</script>

</body>
</html>
